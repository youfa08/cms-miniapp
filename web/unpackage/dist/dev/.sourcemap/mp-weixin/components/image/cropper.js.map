{"version":3,"sources":["webpack:///D:/studygit/cms-miniapp/web/components/image/cropper.vue?c6e8","webpack:///D:/studygit/cms-miniapp/web/components/image/cropper.vue?ba21","webpack:///D:/studygit/cms-miniapp/web/components/image/cropper.vue?5985","webpack:///D:/studygit/cms-miniapp/web/components/image/cropper.vue?b65c","uni-app:///components/image/cropper.vue","webpack:///D:/studygit/cms-miniapp/web/components/image/cropper.vue?eb5d","webpack:///D:/studygit/cms-miniapp/web/components/image/cropper.vue?54ee"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgI;AAChI;AAC2D;AACL;AACsC;;;AAG5F;AACqL;AACrL,gBAAgB,8LAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,8FAAM;AACR,EAAE,uGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,kGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAirB,CAAgB,ssBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC4CrsB;AACA;AACA;AACA,kBADA;AAEA,iBAFA,EADA;;AAKA;AACA,mBADA;AAEA,oBAFA,EALA;;AASA;AACA,kBADA;AAEA,kBAFA,EATA;;AAaA;AACA,kBADA;AAEA,kBAFA,EAbA;;AAiBA;AACA,kBADA;AAEA,mBAFA,EAjBA;;AAqBA;AACA,kBADA;AAEA,mBAFA,EArBA;;AAyBA;AACA,mBADA;AAEA,oBAFA,EAzBA,EADA;;;AA+BA,MA/BA,kBA+BA;AACA;AACA;AACA,mBADA,EADA;;AAIA;AACA,gBADA;AAEA,eAFA;AAGA,+BAHA;AAIA,iCAJA,EAJA;;AAUA;AACA,gBADA;AAEA,eAFA;AAGA,kBAHA;AAIA,mBAJA,EAVA;;AAgBA;AACA,kBADA;AAEA,mBAFA,EAhBA;;AAoBA;AACA,yBADA;AAEA,2BAFA,EApBA;;AAwBA,iBAxBA;AAyBA,cAzBA;AA0BA;AACA;AACA,iBADA;AAEA,gBAFA;AAGA,kBAHA;AAIA,mBAJA,EADA;;AAOA;AACA,iBADA;AAEA,gBAFA;AAGA,kBAHA;AAIA,mBAJA,EAPA,EA1BA;;;AAwCA,mBAxCA;AAyCA,mBAzCA;;AA2CA,GA3EA;AA4EA,SA5EA,qBA4EA;;;;;;AAMA;AACA;AACA,GApFA;AAqFA;AACA,aADA,qBACA,EADA,EACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YADA,CACA,OADA;AAEA,wBAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA,EAEA,GAFA;AAGA,OAvCA;AAwCA,UAxCA;AAyCA,KAvDA;AAwDA,eAxDA,yBAwDA,EAxDA;AAyDA,cAzDA,sBAyDA,EAzDA,EAyDA,IAzDA,EAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA7EA;AA8EA,aA9EA,qBA8EA,EA9EA,EA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OANA,MAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KApGA;AAqGA,YArGA,oBAqGA,EArGA,EAqGA;AACA;AACA;AACA;AACA,KAzGA;AA0GA,eA1GA,uBA0GA,EA1GA,EA0GA;AACA;AACA;AACA;AACA,KA9GA;AA+GA,aA/GA,uBA+GA;AACA;AACA;AACA;AACA,OAFA,EAEA,GAFA;AAGA,KApHA;AAqHA,YArHA,sBAqHA;AACA;AACA;AACA;AACA;AACA,KA1HA;AA2HA,aA3HA,uBA2HA;AACA;AACA;AACA;AACA,YADA,CACA,OADA;AAEA,wBAFA,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OA7BA;AA8BA,UA9BA;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OARA,EAQA,GARA;AASA,KAtKA;AAuKA,aAvKA,qBAuKA,EAvKA,EAuKA,EAvKA,EAuKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAxLA;AAyLA,cAzLA,sBAyLA,EAzLA,EAyLA,EAzLA,EAyLA,EAzLA,EAyLA,EAzLA,EAyLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KApOA;AAqOA,cArOA,sBAqOA,EArOA,EAqOA,EArOA,EAqOA,IArOA,EAqOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAjRA;AAkRA,aAlRA,qBAkRA,MAlRA,EAkRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KA7RA;AA8RA,WA9RA,qBA8RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBADA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,gCADA;AAEA;AACA;;;;;;AAMA;AACA,4BADA;;AAGA,eAZA;AAaA;AACA;AACA,eAfA;AAgBA;AACA;AACA,eAlBA,EADA;;AAqBA,kBArBA;AAsBA,WAvBA,EAuBA,GAvBA;AAwBA,SAzBA;AA0BA,OA5BA,EA4BA,GA5BA;AA6BA,KAvVA;AAwVA,UAxVA,oBAwVA;AACA;AACA,KA1VA,EArFA,E;;;;;;;;;;;;;AC5CA;AAAA;AAAA;AAAA;AAA2wC,CAAgB,4uCAAG,EAAC,C;;;;;;;;;;;ACA/xC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/image/cropper.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./cropper.vue?vue&type=template&id=b1001ba4&scoped=true&\"\nvar renderjs\nimport script from \"./cropper.vue?vue&type=script&lang=js&\"\nexport * from \"./cropper.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cropper.vue?vue&type=style&index=0&id=b1001ba4&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b1001ba4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/image/cropper.vue\"\nexport default component.exports","export * from \"-!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cropper.vue?vue&type=template&id=b1001ba4&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cropper.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cropper.vue?vue&type=script&lang=js&\"","<template>\n\t<view v-show=\"url\" class=\"cropper\">\n\t\t<canvas :style=\"{ width: target.width + 'px', height: target.height + 'px' }\" canvas-id=\"target\"></canvas>\n\t\t<view class=\"body\">\n\t\t\t<image\n\t\t\t\tv-if=\"url\"\n\t\t\t\tclass=\"image\"\n\t\t\t\t@load=\"imageLoad\"\n\t\t\t\t:style=\"{ left: image.left + 'px', top: image.top + 'px', width: image.width + 'px', height: image.height + 'px' }\"\n\t\t\t\t:src=\"url\"\n\t\t\t></image>\n\t\t\t<view v-if=\"mask.show\" class=\"mask\"></view>\n\t\t\t<view @touchstart=\"touchStart($event, 'plank')\" @touchmove=\"touchMove\" @touchend=\"touchEnd\" @touchcancel=\"touchCancel\" class=\"plank\">\n\t\t\t\t<view\n\t\t\t\t\tclass=\"frame\"\n\t\t\t\t\t@touchstart=\"touchStart($event, 'frame')\"\n\t\t\t\t\t@touchstart.stop.prevent=\"touchHandle\"\n\t\t\t\t\t:style=\"{ left: frame.left + 'px', top: frame.top + 'px', width: frame.width + 'px', height: frame.height + 'px' }\"\n\t\t\t\t>\n\t\t\t\t\t<canvas v-if=\"mask.show\" class=\"canvas\" :style=\"{ width: frame.width + 'px', height: frame.height + 'px' }\" canvas-id=\"canvas\"></canvas>\n\t\t\t\t\t<view class=\"rect\"></view>\n\t\t\t\t\t<view class=\"line-one\"></view>\n\t\t\t\t\t<view class=\"line-two\"></view>\n\t\t\t\t\t<view class=\"line-three\"></view>\n\t\t\t\t\t<view class=\"line-four\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'left')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-left\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'right')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-right\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'top')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-top\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'bottom')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-bottom\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'left-top')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-left-top\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'left-bottom')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-left-bottom\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'right-top')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-right-top\"></view>\n\t\t\t\t\t<view @touchstart=\"touchStart($event, 'right-bottom')\" @touchstart.stop.prevent=\"touchHandle\" class=\"frame-right-bottom\"></view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<view class=\"toolbar\">\n\t\t\t<button @tap=\"cancel\" class=\"btn-cancel\">取消</button>\n\t\t\t<button @tap=\"confirm\" class=\"btn-ok\">确定</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nexport default {\n\tprops: {\n\t\turl: {\n\t\t\ttype: String,\n\t\t\tdefault: ''\n\t\t},\n\t\tfixed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 200\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 200\n\t\t},\n\t\tmaxWidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1024\n\t\t},\n\t\tmaxHeight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1024\n\t\t},\n\t\tblob: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tmask: {\n\t\t\t\tshow: false\n\t\t\t},\n\t\t\tframe: {\n\t\t\t\tleft: 50,\n\t\t\t\ttop: 50,\n\t\t\t\twidth: this.width / 1.5,\n\t\t\t\theight: this.height / 1.5\n\t\t\t},\n\t\t\timage: {\n\t\t\t\tleft: 20,\n\t\t\t\ttop: 20,\n\t\t\t\twidth: 300,\n\t\t\t\theight: 400\n\t\t\t},\n\t\t\treal: {\n\t\t\t\twidth: 100,\n\t\t\t\theight: 100\n\t\t\t},\n\t\t\ttarget: {\n\t\t\t\twidth: this.width,\n\t\t\t\theight: this.height\n\t\t\t},\n\t\t\ttouches: [],\n\t\t\ttype: '',\n\t\t\tstart: {\n\t\t\t\tframe: {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0\n\t\t\t\t},\n\t\t\t\timage: {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0\n\t\t\t\t}\n\t\t\t},\n\t\t\ttimeoutId: -1,\n\t\t\tcontext: null\n\t\t};\n\t},\n\tmounted() {\n\t\t//#ifdef H5\n\t\tthis.$el.addEventListener('touchmove', ev => {\n\t\t\tev.preventDefault();\n\t\t});\n\t\t// #endif\n\t\tthis.context = uni.createCanvasContext('canvas', this);\n\t\tthis.targetContext = uni.createCanvasContext('target', this);\n\t},\n\tmethods: {\n\t\timageLoad(ev) {\n\t\t\tthis.mask.show = true;\n\t\t\tthis.real.width = ev.detail.width;\n\t\t\tthis.real.height = ev.detail.height;\n\t\t\tthis.image.width = ev.detail.width;\n\t\t\tthis.image.height = ev.detail.height;\n\t\t\tthis.frame.width = this.width / 1.5;\n\t\t\tthis.frame.height = this.height / 1.5;\n\t\t\tif (!this.fixed) {\n\t\t\t\tthis.frame.width = this.image.width;\n\t\t\t\tthis.frame.height = this.image.height;\n\t\t\t}\n\t\t\tvar query = uni.createSelectorQuery().in(this);\n\t\t\tquery\n\t\t\t\t.select('.body')\n\t\t\t\t.boundingClientRect(data => {\n\t\t\t\t\tvar bw = data.width;\n\t\t\t\t\tvar bh = data.height;\n\t\t\t\t\tvar fw = this.frame.width;\n\t\t\t\t\tvar fh = this.frame.height;\n\t\t\t\t\tvar tw = bw * 0.8;\n\t\t\t\t\tvar th = bh * 0.8;\n\t\t\t\t\tvar sx = tw / fw;\n\t\t\t\t\tvar sy = th / fh;\n\t\t\t\t\tvar scale = sx;\n\t\t\t\t\tif (sx < sy) {\n\t\t\t\t\t\tscale = sy;\n\t\t\t\t\t}\n\t\t\t\t\ttw = fw * scale;\n\t\t\t\t\tth = fh * scale;\n\t\t\t\t\tvar tx = (bw - tw) / 2;\n\t\t\t\t\tvar ty = (bh - th) / 2;\n\t\t\t\t\tthis.frame.width = tw;\n\t\t\t\t\tthis.frame.height = th;\n\t\t\t\t\tthis.frame.left = tx;\n\t\t\t\t\tthis.frame.top = ty;\n\n\t\t\t\t\tvar iw = this.image.width;\n\t\t\t\t\tvar ih = this.image.height;\n\t\t\t\t\tsx = tw / iw;\n\t\t\t\t\tsy = th / ih;\n\t\t\t\t\tscale = sx;\n\t\t\t\t\tif (sx < sy) {\n\t\t\t\t\t\tscale = sy;\n\t\t\t\t\t}\n\t\t\t\t\tthis.image.width = iw * scale;\n\t\t\t\t\tthis.image.height = ih * scale;\n\t\t\t\t\tthis.image.left = (bw - this.image.width) / 2;\n\t\t\t\t\tthis.image.top = (bh - this.image.height) / 2;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.trimImage();\n\t\t\t\t\t}, 100);\n\t\t\t\t})\n\t\t\t\t.exec();\n\t\t},\n\t\ttouchHandle() {},\n\t\ttouchStart(ev, type) {\n\t\t\tthis.stopTime();\n\t\t\tthis.mask.show = false;\n\t\t\tif (this.touches.length == 0) {\n\t\t\t\tthis.type = type;\n\t\t\t\tthis.start.frame.left = this.frame.left;\n\t\t\t\tthis.start.frame.top = this.frame.top;\n\t\t\t\tthis.start.frame.width = this.frame.width;\n\t\t\t\tthis.start.frame.height = this.frame.height;\n\t\t\t\tthis.start.image.left = this.image.left;\n\t\t\t\tthis.start.image.top = this.image.top;\n\t\t\t\tthis.start.image.width = this.image.width;\n\t\t\t\tthis.start.image.height = this.image.height;\n\t\t\t}\n\t\t\tvar touches = ev.changedTouches;\n\t\t\tfor (var i = 0; i < touches.length; i++) {\n\t\t\t\tvar touch = touches[i];\n\t\t\t\t// this.touches[touch.identifier] = touch;\n\t\t\t\tthis.touches.push(touch);\n\t\t\t}\n\t\t},\n\t\ttouchMove(ev) {\n\t\t\tthis.stopTime();\n\t\t\tev.preventDefault();\n\t\t\tvar touches = ev.touches;\n\t\t\tif (this.touches.length == 1) {\n\t\t\t\tif (this.type == 'plank' || this.type == 'frame' || this.fixed) {\n\t\t\t\t\tthis.moveImage(this.touches[0], touches[0]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.scaleFrame(this.touches[0], touches[0], this.type);\n\t\t\t\t}\n\t\t\t} else if (this.touches.length == 2 && touches.length == 2) {\n\t\t\t\tvar ta = this.touches[0];\n\t\t\t\tvar tb = this.touches[1];\n\t\t\t\tvar tc = touches[0];\n\t\t\t\tvar td = touches[1];\n\t\t\t\tif (ta.identifier != tc.identifier) {\n\t\t\t\t\tvar temp = tc;\n\t\t\t\t\ttc = td;\n\t\t\t\t\ttd = temp;\n\t\t\t\t}\n\t\t\t\tthis.scaleImage(ta, tb, tc, td);\n\t\t\t}\n\t\t},\n\t\ttouchEnd(ev) {\n\t\t\tthis.type = '';\n\t\t\tthis.touches = [];\n\t\t\tthis.startTime();\n\t\t},\n\t\ttouchCancel(ev) {\n\t\t\tthis.type = '';\n\t\t\tthis.touches = [];\n\t\t\tthis.startTime();\n\t\t},\n\t\tstartTime() {\n\t\t\tthis.stopTime();\n\t\t\tthis.timeoutId = setTimeout(() => {\n\t\t\t\tthis.trimImage();\n\t\t\t}, 800);\n\t\t},\n\t\tstopTime() {\n\t\t\tif (this.timeoutId >= 0) {\n\t\t\t\tclearTimeout(this.timeoutId);\n\t\t\t\tthis.timeoutId = -1;\n\t\t\t}\n\t\t},\n\t\ttrimImage() {\n\t\t\tthis.mask.show = true;\n\t\t\tvar query = uni.createSelectorQuery().in(this);\n\t\t\tquery\n\t\t\t\t.select('.body')\n\t\t\t\t.boundingClientRect(data => {\n\t\t\t\t\tvar bw = data.width;\n\t\t\t\t\tvar bh = data.height;\n\t\t\t\t\tvar fw = this.frame.width;\n\t\t\t\t\tvar fh = this.frame.height;\n\t\t\t\t\tvar tw = bw * 0.8;\n\t\t\t\t\tvar th = bh * 0.8;\n\t\t\t\t\tvar sx = tw / fw;\n\t\t\t\t\tvar sy = th / fh;\n\t\t\t\t\tvar scale = sx;\n\t\t\t\t\tif (sx > sy) {\n\t\t\t\t\t\tscale = sy;\n\t\t\t\t\t}\n\t\t\t\t\ttw = fw * scale;\n\t\t\t\t\tth = fh * scale;\n\t\t\t\t\tvar tx = (bw - tw) / 2;\n\t\t\t\t\tvar ty = (bh - th) / 2;\n\t\t\t\t\tvar ax = tx - this.frame.left + (this.frame.left - this.image.left) * (1 - scale);\n\t\t\t\t\tvar ay = ty - this.frame.top + (this.frame.top - this.image.top) * (1 - scale);\n\t\t\t\t\tthis.frame.width = tw;\n\t\t\t\t\tthis.frame.height = th;\n\t\t\t\t\tthis.frame.left = tx;\n\t\t\t\t\tthis.frame.top = ty;\n\t\t\t\t\tthis.image.width *= scale;\n\t\t\t\t\tthis.image.height *= scale;\n\t\t\t\t\tthis.image.left += ax;\n\t\t\t\t\tthis.image.top += ay;\n\t\t\t\t})\n\t\t\t\t.exec();\n\t\t\tsetTimeout(() => {\n\t\t\t\tvar scale = this.image.width / this.real.width;\n\t\t\t\tvar x = (this.frame.left - this.image.left) / scale;\n\t\t\t\tvar y = (this.frame.top - this.image.top) / scale;\n\t\t\t\tvar width = this.frame.width / scale;\n\t\t\t\tvar height = this.frame.height / scale;\n\t\t\t\tthis.context.drawImage(this.url, x, y, width, height, 0, 0, this.frame.width, this.frame.height);\n\t\t\t\tthis.context.draw(false);\n\t\t\t}, 100);\n\t\t},\n\t\tmoveImage(ta, tb) {\n\t\t\tvar ax = tb.clientX - ta.clientX;\n\t\t\tvar ay = tb.clientY - ta.clientY;\n\t\t\tthis.image.left = this.start.image.left + ax;\n\t\t\tthis.image.top = this.start.image.top + ay;\n\t\t\tif (this.image.left > this.frame.left) {\n\t\t\t\tthis.image.left = this.frame.left;\n\t\t\t}\n\t\t\tif (this.image.top > this.frame.top) {\n\t\t\t\tthis.image.top = this.frame.top;\n\t\t\t}\n\t\t\tif (this.image.left + this.image.width < this.frame.left + this.frame.width) {\n\t\t\t\tthis.image.left = this.frame.left + this.frame.width - this.image.width;\n\t\t\t}\n\t\t\tif (this.image.top + this.image.height < this.frame.top + this.frame.height) {\n\t\t\t\tthis.image.top = this.frame.top + this.frame.height - this.image.height;\n\t\t\t}\n\t\t},\n\t\tscaleImage(ta, tb, tc, td) {\n\t\t\tvar x1 = ta.clientX;\n\t\t\tvar y1 = ta.clientY;\n\t\t\tvar x2 = tb.clientX;\n\t\t\tvar y2 = tb.clientY;\n\t\t\tvar x3 = tc.clientX;\n\t\t\tvar y3 = tc.clientY;\n\t\t\tvar x4 = td.clientX;\n\t\t\tvar y4 = td.clientY;\n\t\t\tvar ol = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n\t\t\tvar el = Math.sqrt((x3 - x4) * (x3 - x4) + (y3 - y4) * (y3 - y4));\n\t\t\tvar ocx = (x1 + x2) / 2;\n\t\t\tvar ocy = (y1 + y2) / 2;\n\t\t\tvar ecx = (x3 + x4) / 2;\n\t\t\tvar ecy = (y3 + y4) / 2;\n\t\t\tvar ax = ecx - ocx;\n\t\t\tvar ay = ecy - ocy;\n\t\t\tvar scale = el / ol;\n\t\t\tif (this.start.image.width * scale < this.frame.width) {\n\t\t\t\tscale = this.frame.width / this.start.image.width;\n\t\t\t}\n\t\t\tif (this.start.image.height * scale < this.frame.height) {\n\t\t\t\tscale = this.frame.height / this.start.image.height;\n\t\t\t}\n\t\t\tif (this.start.image.width * scale < this.frame.width) {\n\t\t\t\tscale = this.frame.width / this.start.image.width;\n\t\t\t}\n\t\t\tthis.image.left = this.start.image.left + ax - (ocx - this.start.image.left) * (scale - 1);\n\t\t\tthis.image.top = this.start.image.top + ay - (ocy - this.start.image.top) * (scale - 1);\n\t\t\tthis.image.width = this.start.image.width * scale;\n\t\t\tthis.image.height = this.start.image.height * scale;\n\t\t\tif (this.image.left > this.frame.left) {\n\t\t\t\tthis.image.left = this.frame.left;\n\t\t\t}\n\t\t\tif (this.image.top > this.frame.top) {\n\t\t\t\tthis.image.top = this.frame.top;\n\t\t\t}\n\t\t\tif (this.image.left + this.image.width < this.frame.left + this.frame.width) {\n\t\t\t\tthis.image.left = this.frame.left + this.frame.width - this.image.width;\n\t\t\t}\n\t\t\tif (this.image.top + this.image.height < this.frame.top + this.frame.height) {\n\t\t\t\tthis.image.top = this.frame.top + this.frame.height - this.image.height;\n\t\t\t}\n\t\t},\n\t\tscaleFrame(ta, tb, type) {\n\t\t\tvar ax = tb.clientX - ta.clientX;\n\t\t\tvar ay = tb.clientY - ta.clientY;\n\t\t\tvar x1 = this.start.frame.left;\n\t\t\tvar y1 = this.start.frame.top;\n\t\t\tvar x2 = this.start.frame.left + this.start.frame.width;\n\t\t\tvar y2 = this.start.frame.top + this.start.frame.height;\n\t\t\tif (type == 'left') {\n\t\t\t\tx1 += ax;\n\t\t\t} else if (type == 'right') {\n\t\t\t\tx2 += ax;\n\t\t\t} else if (type == 'top') {\n\t\t\t\ty1 += ay;\n\t\t\t} else if (type == 'bottom') {\n\t\t\t\ty2 += ay;\n\t\t\t} else if (type == 'left-top') {\n\t\t\t\tx1 += ax;\n\t\t\t\ty1 += ay;\n\t\t\t} else if (type == 'left-bottom') {\n\t\t\t\tx1 += ax;\n\t\t\t\ty2 += ay;\n\t\t\t} else if (type == 'right-top') {\n\t\t\t\tx2 += ax;\n\t\t\t\ty1 += ay;\n\t\t\t} else if (type == 'right-bottom') {\n\t\t\t\tx2 += ax;\n\t\t\t\ty2 += ay;\n\t\t\t}\n\t\t\tif (x1 < this.image.left) {\n\t\t\t\tx1 = this.image.left;\n\t\t\t}\n\t\t\tif (y1 < this.image.top) {\n\t\t\t\ty1 = this.image.top;\n\t\t\t}\n\t\t\tif (x2 > this.image.left + this.image.width) {\n\t\t\t\tx2 = this.image.left + this.image.width;\n\t\t\t}\n\t\t\tif (y2 > this.image.top + this.image.height) {\n\t\t\t\ty2 = this.image.top + this.image.height;\n\t\t\t}\n\t\t\tthis.frame.left = x1;\n\t\t\tthis.frame.top = y1;\n\t\t\tthis.frame.width = x2 - x1;\n\t\t\tthis.frame.height = y2 - y1;\n\t\t},\n\t\tparseBlob(base64) {\n\t\t\tvar arr = base64.split(',');\n\t\t\tvar mime = arr[0].match(/:(.*?);/)[1];\n\t\t\tvar bstr = atob(arr[1]);\n\t\t\tvar n = bstr.length;\n\t\t\tvar u8arr = new Uint8Array(n);\n\t\t\tfor (var i = 0; i < n; i++) {\n\t\t\t\tu8arr[i] = bstr.charCodeAt(i);\n\t\t\t}\n\t\t\tvar url = URL || webkitURL;\n\t\t\treturn url.createObjectURL(new Blob([u8arr], { type: mime }));\n\t\t},\n\t\tconfirm() {\n\t\t\tvar scale = this.image.width / this.real.width;\n\t\t\tvar x = (this.frame.left - this.image.left) / scale;\n\t\t\tvar y = (this.frame.top - this.image.top) / scale;\n\t\t\tvar width = this.frame.width / scale;\n\t\t\tvar height = this.frame.height / scale;\n\t\t\tvar tw = width;\n\t\t\tvar th = height;\n\t\t\tif (this.fixed) {\n\t\t\t\ttw = this.width / 1.5 / 2;\n\t\t\t\tth = this.height / 1.5 / 2;\n\t\t\t} else {\n\t\t\t\tif (tw > this.maxWidth / 2) {\n\t\t\t\t\tvar sc = this.maxWidth / 2 / tw;\n\t\t\t\t\ttw = tw * sc;\n\t\t\t\t\tth = th * sc;\n\t\t\t\t}\n\t\t\t\tif (th > this.maxHeight / 2) {\n\t\t\t\t\tvar sc = this.maxHeight / 2 / th;\n\t\t\t\t\tth = th * sc;\n\t\t\t\t\ttw = tw * sc;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.target.width = tw;\n\t\t\tthis.target.height = th;\n\t\t\tuni.showLoading({\n\t\t\t\ttitle: '图片裁剪…'\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.targetContext.drawImage(this.url, x, y, width, height, 0, 0, tw, th);\n\t\t\t\tthis.targetContext.draw(false, () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tuni.canvasToTempFilePath(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcanvasId: 'target',\n\t\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\t\tvar path = res.tempFilePath;\n\t\t\t\t\t\t\t\t// #ifdef H5\n\t\t\t\t\t\t\t\tif (this.blob) {\n\t\t\t\t\t\t\t\t\tpath = this.parseBlob(path);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// #endif\n\t\t\t\t\t\t\t\tthis.$emit('ok', {\n\t\t\t\t\t\t\t\t\tpath: path\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfail: ev => {\n\t\t\t\t\t\t\t\tconsole.log(ev);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis\n\t\t\t\t\t)}, 200);\n\t\t\t\t});\n\t\t\t}, 200);\n\t\t},\n\t\tcancel() {\n\t\t\tthis.$emit('cancel');\n\t\t}\n\t}\n};\n</script>\n\n<style scoped lang=\"scss\">\n.cropper {\n\tposition: fixed;\n\twidth: 100%;\n\theight: 100%;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 997;\n}\n.toolbar {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 120rpx;\n\tleft: 0rpx;\n\tbottom: 0rpx;\n\tbox-sizing: border-box;\n\tbackground: #000;\n}\n.btn-cancel {\n\tposition: absolute;\n\tleft: 100rpx;\n\ttop: 12rpx;\n\tfont-size: 30rpx;\n\tpadding: 0 80rpx;\n\tcolor: #353535;\n\tborder-radius: 150rpx;\n\tbackground: #fff;\n\theight: 70rpx;\n\tline-height: 70rpx;\n}\n.btn-ok {\n\tposition: absolute;\n\tright: 100rpx;\n\ttop: 12rpx;\n\tfont-size: 30rpx;\n\tpadding: 0 80rpx;\n\tcolor: #fff;\n\tborder-radius: 150rpx;\n\tbackground: #099e55;\n\theight: 70rpx;\n\tline-height: 70rpx;\n}\n.body {\n\tposition: absolute;\n\tleft: 0rpx;\n\tright: 0rpx;\n\ttop: 0rpx;\n\tbottom: 120rpx;\n\tbackground: black;\n\toverflow: hidden;\n}\n.mask {\n\tposition: absolute;\n\tleft: 0rpx;\n\tright: 0rpx;\n\ttop: 0rpx;\n\tbottom: 0rpx;\n\tbackground: black;\n\topacity: 0.4;\n}\n.plank {\n\tposition: absolute;\n\tleft: 0rpx;\n\tright: 0rpx;\n\ttop: 0rpx;\n\tbottom: 0rpx;\n}\n.image {\n\tposition: absolute;\n}\n.frame {\n\tposition: absolute;\n}\n.canvas {\n\tposition: absolute;\n\tdisplay: block;\n\tleft: 0px;\n\ttop: 0px;\n}\n.rect {\n\tposition: absolute;\n\tleft: -2px;\n\ttop: -2px;\n\twidth: 100%;\n\theight: 100%;\n\tborder: 2px solid white;\n}\n.line-one {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 1px;\n\tbackground: white;\n\tleft: 0;\n\ttop: 33.3%;\n}\n.line-two {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 1px;\n\tbackground: white;\n\tleft: 0;\n\ttop: 66.7%;\n}\n.line-three {\n\tposition: absolute;\n\twidth: 1px;\n\theight: 100%;\n\tbackground: white;\n\ttop: 0;\n\tleft: 33.3%;\n}\n.line-four {\n\tposition: absolute;\n\twidth: 1px;\n\theight: 100%;\n\tbackground: white;\n\ttop: 0;\n\tleft: 66.7%;\n}\n.frame-left {\n\tposition: absolute;\n\theight: 100%;\n\twidth: 8px;\n\tleft: -4px;\n\ttop: 0;\n}\n.frame-right {\n\tposition: absolute;\n\theight: 100%;\n\twidth: 8px;\n\tright: -4px;\n\ttop: 0;\n}\n.frame-top {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 8px;\n\ttop: -4px;\n\tleft: 0;\n}\n.frame-bottom {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 8px;\n\tbottom: -4px;\n\tleft: 0;\n}\n.frame-left-top {\n\tposition: absolute;\n\twidth: 20px;\n\theight: 20px;\n\tleft: -6px;\n\ttop: -6px;\n\tborder-left: 4px solid red;\n\tborder-top: 4px solid red;\n}\n.frame-left-bottom {\n\tposition: absolute;\n\twidth: 20px;\n\theight: 20px;\n\tleft: -6px;\n\tbottom: -6px;\n\tborder-left: 4px solid red;\n\tborder-bottom: 4px solid red;\n}\n.frame-right-top {\n\tposition: absolute;\n\twidth: 20px;\n\theight: 20px;\n\tright: -6px;\n\ttop: -6px;\n\tborder-right: 4px solid red;\n\tborder-top: 4px solid red;\n}\n.frame-right-bottom {\n\tposition: absolute;\n\twidth: 20px;\n\theight: 20px;\n\tright: -6px;\n\tbottom: -6px;\n\tborder-right: 4px solid red;\n\tborder-bottom: 4px solid red;\n}\n</style>\n","import mod from \"-!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cropper.vue?vue&type=style&index=0&id=b1001ba4&scoped=true&lang=scss&\"; export default mod; export * from \"-!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\personsoftware\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./cropper.vue?vue&type=style&index=0&id=b1001ba4&scoped=true&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1612753450538\n      var cssReload = require(\"E:/personsoftware/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}